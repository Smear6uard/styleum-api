[build]
builder = "nixpacks"

[deploy]
startCommand = "npm start"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# 4AM US Eastern = 9AM UTC
[[crons]]
schedule = "0 9 * * *"
endpoint = "/cron/pre-generate"

# 9AM US Eastern = 2PM UTC
[[crons]]
schedule = "0 14 * * *"
endpoint = "/cron/morning-notifications"

# Midnight UTC daily - gamification reset (XP, streaks, challenges)
[[crons]]
schedule = "0 0 * * *"
endpoint = "https://${{RAILWAY_PUBLIC_DOMAIN}}/cron/daily-gamification-reset"
headers = { authorization = "Bearer ${{CRON_SECRET}}" }
